---
title: "antibiotics"
date: "`r format(Sys.Date())`"
author:
- Douglas Campbell^1^*
- Ruby Muzzatti^1^*
- Avery MacKinnon^1^*
output:
  bookdown::html_document2:
    code_folding: show
    keep_md: yes
    toc: TRUE
    toc_float: TRUE
    toc_depth: 6
    fig_caption: yes
bibliography: RPackageCitations.bib
csl: plos-one.csl
editor_options: 
  markdown: 
    wrap: 72
---
```{css, echo=FALSE}
p.caption {
  font-size: 18px;
}
```


# Affiliations {-}
^1^Mount Allison University, New Brunswick, Canada  

*corresponding author  

# Acknowledgements {-}
Brackets minus after heading excludes heading from numbering.
DAC was supported by the Canada Research Chairs.

# Overview
File import functions read files into R objects, commonly data frames.
I love github

Things Kingsley will do

Relative abundance of colonies by flow type (inflow vs. outflow).
Relative abundance of colonies by antibiotics.
Combined abundance of colonies by flow type and antibiotics (stacked or grouped).
Interpretation
Inflow vs. Outflow: This will show whether the colony abundance is higher in the inflow or the outflow of your sample.

Antibiotic Comparison: You will observe which antibiotic showed higher or lower bacterial counts, reflecting relative resistance or susceptibility.

Combined abundance: This will show a detailed breakdown of colony abundance for each antibiotic within inflow and outflow categories.

Note, Kingsley is excluding the colonies in a  lawn becaause  a lawn contains infinity number of colonies

# Introduction, Avery

# Materials & Methods, Ruby

## Set chunk options
Formatted display of content from .md file on GitHub site.
Upon knitr figures will be saved to 'Figs/'
```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, error = FALSE, message = FALSE)
knitr::opts_chunk$set(fig.path='Figs/')
```

## Load packages
```{r packages, include = FALSE}
library(tidyverse) #core packages from Tidyverse
library(googledrive) #access to GoogleDrive
library(googlesheets4) #access to GoogleSheets
##library(data.table) #fast data handling;  complement to tidverse dplyr
##library(lubridate) #tidyverse handling dates & times
library(knitr)
library(ggmap) #tools for using maps from GoogleEarth & GoogleMaps
```

## Import MetaData from a GoogleSheet
MetaData in a GoogleSheet is more generic than a project-specific .csv edited and saved locally.
The GoogleSheet interface can be tricky.
Repeatedly reading from GoogleDrive can provoke a throttle from Google.
```{r load Catalog direct from googlesheet, results = "hide"}


#Instead of sending a token, googlesheets4 will send an API key. This can be used to access public resources for which no Google sign-in is required. 
googlesheets4::gs4_deauth()



#URL or ID of a GoogleSheet readable by anyone (with a link)
MetaData <- googlesheets4::read_sheet("https://docs.google.com/spreadsheets/d/1J6Ip_VzQCpMvZSZFiQVm0LSXW6wn2uSi7_NohkacjJ0/edit?gid=0#gid=0", sheet = "MetaData")

DataSheet <- googlesheets4::read_sheet("https://docs.google.com/spreadsheets/d/1J6Ip_VzQCpMvZSZFiQVm0LSXW6wn2uSi7_NohkacjJ0/edit?gid=0#gid=0", sheet = "Data")
  # googlesheets4::read_sheet has a  "feature" to set the type of columns it can't parse to a list.
  # ggplot/dplyr does not like working with a dataframe of lists.
  # In this case variable column WL is set to a list since some values are numbers, some are strings, some are blank.
  # To fix this, first drop all rows missing WL, then unlist.
  # Must first drop NA rows since unlist will collapse NULL lists, then the unlisted WL is a shorter length than original WL column, which mutate does not like.
   #same link, updated data in it


#Catalog <- as.data.frame(Catalog) %>%
  #mutate(ExpDate = lubridate::ymd(ExpDate))
```

## Merged  DataSheet with MetaData by the value of PlateID
```{r merging DataSheet with MetaData by the value of PlateID}
DataMeta <- left_join(x  = DataSheet, y = MetaData, by = "PlateID")
```

## In-Lab Work 
3 samples from inflows and 3 samples from outflows of the water fowl park water body were collected. 

```{r generate map}
## Load a map of Tantramar from GoogleMaps 
## https://www.littlemissdata.com/blog/maps  

register_google(key = "")

# create a map covering the areas we sampled
MaxLat <- max(MetaData$Lat, na.rm = TRUE)
MinLat <- min(MetaData$Lat, na.rm = TRUE)
MaxLon <- max(MetaData$Lon, na.rm = TRUE)
MinLon <- min(MetaData$Lon, na.rm = TRUE)
CentreLat = mean(MetaData$Lat, na.rm = TRUE)
CentreLon = mean(MetaData$Lon, na.rm = TRUE)

SackvilleMap <- get_googlemap(center = c(lon = CentreLon, lat = CentreLat),
                    zoom = 16,
                    scale = 2,
                    maptype ='satellite',
                    color = 'color')

ggmap(SackvilleMap)

```
with removal of key, first code to call up the plain map has an error, but the map with overlay still working?
```{r overlap sampling locations}
ggmap(SackvilleMap) +
 geom_point(data = MetaData, aes(x = Lon, y = Lat, colour = InOut), size = 3)  +
  scale_colour_manual(values = c("In" = "darkslategray3", "Out" = "#e0115f"), na.translate = FALSE) +
  theme(legend.position = "bottom") +
labs(title = "Sampling Locations in Sackville Waterfowl Park",
              caption = "October, 2024")
```
 
Protocols from Szybalski and Bryson (1952) and Lui *et al.* (2011) were adapted to mkae antibiotic gradient agar plates. 

Antibiotics were water soluble, tryptic soy agar was divided into 3 for the antibiotic mixtures before being autoclaved, to ensure no contamination.

Ampicillin:
5.02 g ampicillin powder/500 mL TSA = 10.04 mg/mL

Due to lack of stock antibiotic powder, Kanamycin was made to the following specifications:
4.67 g kanamycin powder/500 mL TSA = 9.34 mg/mL

Streptomycin:
5 g streptomycin powder/500 mL = 10 mg/mL

Each 100 mm plate had 15 mL of the antibiotic agar added, then was tiled to an angle kept consistent using the edge of a scoopula. When cool and solidified, 15 mL of the tryptic soy agar was added to the diagonal antibiotic layer. Graident plates were left to diffuse for 24 hours at room temprature.

1 mL of each sample was cultured on three antibiotic gradient plates with the tryptic soy agar and antibiotic (streptomycin, ampicillin, kanamycin) gradient ranging from 0 to ~10 mg/mL. 


The plates, inoculated on October 23, were left at room temperature and images were taken on October 25, October 28, and October 29.

Ideally, the antibiotic gradient plates serve as their own control since at one end the concentration of the antibiotic is zero (Weinberg, 1959). Lab strain *E. coli* (strain info pending... emailed Liza) was used as a control.

#Results and discussion, Samantha Hallett
libraries needed to do code
```{r}
library(dplyr)
library(ggplot2)
```
Effective concentration 
```{r}
avg_effective_conc <- DataMeta %>%
  filter(Colony_Number > 0) %>% # Include rows where colonies are present
  group_by(Antibiotic, ObservationDate) %>%
  summarize(
    Avg_Concentration = mean(AbxConcReached_mgmL, na.rm = TRUE)
  )
print(avg_effective_conc)
```
resistance threshold
```{r}
resistance_threshold <- DataMeta %>%
  group_by(Antibiotic) %>%
  filter(Colony_Number == 0) %>% # Only rows with no colonies
  summarize(
    Resistance_Threshold = min(AbxConcReached_mgmL, na.rm = TRUE)
  )
print(resistance_threshold)
```
comparison across antibiotics (to find the most effective antibiotic)
```{r}
comparison <- DataMeta %>%
  group_by(Antibiotic) %>%
  summarize(
    Avg_ColonyCount = mean(Colony_Number, na.rm = TRUE), # Lower is better for effectiveness
    Resistance_Threshold = min(AbxConcReached_mgmL[Colony_Number == 0], na.rm = TRUE)
  ) %>%
  arrange(Avg_ColonyCount)
print(comparison)
```
growth trends
```{r}
growth_trends <- DataMeta %>%
  group_by(Antibiotic, InOut) %>%
  summarize(
    Avg_ColonyCount = mean(Colony_Number, na.rm = TRUE),
    Avg_Concentration = mean(AbxConcReached_mgmL, na.rm = TRUE)
  )
```
visualize growth trends
```{r}
ggplot(DataMeta, aes(x = AbxConcReached_mgmL, y = Colony_Number, color = InOut)) +
  geom_point() +
  geom_smooth(method = "loess") +
  facet_wrap(~ Antibiotic) +
  labs(
    title = "Growth Trends: Colony Count vs Antibiotic Concentration",
    x = "Antibiotic Concentration",
    y = "Colony Count"
  ) +
  theme_minimal()
```
Environmental impact 
```{r}
location_effectiveness <- DataMeta %>%
  group_by(Location, Antibiotic) %>%
  summarize(
    Avg_ColonyCount = mean(Colony_Number, na.rm = TRUE)
  )
```
visualize environmental impact
```{r}
ggplot(location_effectiveness, aes(x = Location, y = Avg_ColonyCount, fill = Antibiotic)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Environmental Impact on Antibiotic Effectiveness",
    x = "Location",
    y = "Average Colony Count"
  ) +
  theme_minimal()
```
law presence
```{r}
law_relationship <- DataMeta %>%
  group_by(Antibiotic) %>%
  summarize(
    Correlation = cor(Colony_Number, AbxConcReached_mgmL, use = "complete.obs")
  )

print(law_relationship)

```
visualize law relationship
```{r}
ggplot(DataMeta, aes(x = AbxConcReached_mgmL, y = Colony_Number, color = Antibiotic)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Relationship Between Antibiotic Concentration and Colony Count",
    x = "Antibiotic Concentration",
    y = "Colony Count"
  ) +
  theme_minimal()

```

```{r}
 flow_antibiotic_relative <- DataMeta %>%
filter(!is.na(InOut))%>%
  group_by(Antibiotic, InOut)%>%
    summarise(TotalCount = sum(Colony_Number, na.rm = TRUE)) %>%
  ungroup()
                               
                               
       #                        , .by = c() , ))%>%
     #mutate(RelativeAbundance = (TotalCount / sum(TotalCount)) * 100)
```

```{r}
flow_antibiotic_relative %>%
  ggplot()+
  geom_bar(aes(x = Antibiotic, y = TotalCount, colour = InOut, fill = InOut ), stat = "identity")
```


# Results, Ruby

## Ampicillin Trends
October 25, 2024: Opaque cream colour lawn is seen in Ampicillin Out 2 (a and b), Out 3 (a, b, c), Out 1 (a, b, c). 
Semi opaque cream colour lawn in Ampicillin Out 2 (c), In 2 (a, b), In 1 (a, b, c), In 3 (a, b, c).See IMG_2381.
```{r IMG_2381, In3, October 25}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_28/IMG_2381.jpeg")
```

October 28, 2024: Opaque cream/mustard lawn seen in Ampicillin In 1 (a, b, c), Out 3 (a, b, c), Out 1 (a, b, c).
Semi opaque cream colour lawn in Ampicillin Out 2 (a, b, c), In 2 (a, b).
Darker cream to rust gradient (opaque) seen in In 3 (a, b, c). See IMG_2397.
```{r IMG_2397, In3, October 28}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_29/IMG_2397.jpeg")
```

October 29, 2024: Opaque mustard lawn seen in Out 2 (a, b), Out 1 (a, b, c), In 1 (a, b, c).
Opaque cream lawn seen in Out 3 (a, b, c), In 2 (a, b).
Semi opaque cream colour lawn in Ampicillin Out 2 (c).
Darker cream to rust gradient (opaque) seen in In 3 (a, b, c).

## Hot Pink Microbe
October 25, 2024: not seen

October 28, 2024: See in Kanamycin Out 3 (a, b), Streptomycin Out 3 (a, b, c). Not quite a lawn, not clear colonies, looks like paint splatter. See IMG_2377.
```{r IMG_2377, fig.cap="Note the hot pink microbe appearing as both a paint splatter and colonies. Antibiotics from top row to bottom: Ampicillin, Kanamycin, Streptomycin. (Image taken on October 28, 2024)"}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_28/IMG_2377.jpeg")
```

October 29, 2024: See in Kanamycin Out 3 (b, c), Streptomycin Out 3 (a, b, c). Colonies seen on Out 3 (c). See IMG_2394.
```{r IMG_2394, fig.cap="Note the hot pink microbe appearing as both a paint splatter and colonies. Antibiotics from top row to bottom: Ampicillin, Kanamycin, Streptomycin. (Image taken on October 29, 2024)"}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_29/IMG_2394.jpeg")
```


# Discussion, Ruby
## Ampicillin Trends
Unlike the other antibiotics, very little diversity is seen in Ampicillin, no matter the location of the water sample.
The cream/yellow microbes may have already been resistant to Ampicillin, allowing them to outcomplete other microbes in the water sample, or there may have been less resistance of the other microbes to Ampicillin, allowing the cream/yellow microbes to propagate without competition. The darkening of colour of the cream/rust gradient over time looks to be the microbe drying out, since it doesn't further move along the antibiotic gradient after October 28.

## Pink Microbe
ruby note to self: yes this is blank you need to finish this, no nothing was deleted, you didnt write anything


# Results and Discussion, Avery

Analyzing the fungi growing on the plates qualitatively

##Background Research:

Fungi are naturally resistant to antibiotics that kill commensal bacteria (which are those naturally occuring in/on the body), and therefore when antibiotics are used there is an increased likelihood of fungal infections (Jiang et al., 2017). With less bacterial growth, there would be more resources available to the fungi. The antibiotics that we tested (ampicillin, kanamycin, streptomycin) all kill commensal bacteria. This would imply that the more bacteria growing on a plate, the less fungal growth would be observed. 

In our experiment, a lot of fungal growth was observed. This could be from contamination during innoculation, but could also be from the presence of spores in the water samples. 

With this arises the question of whether bacterial or fungal infections are more harmful to ones health, and this really depends on the type of bacteria and fungus present. In a study by Khan et. al. (2024), there overall was higher mortality observed in ICU patients that developed fungal infections than those with bacterial infections. Again, these outcomes do vary greatly with the type of bacteria or fungus because some are more dangerous than others. We were unable to open these plates and identify the bacteria and fungi present because of the potential risk of them being harmful, so in this case we cannot say for sure whether or not the fungi and bacteria were dangerous. It is important to consider that when in contact with water like the samples from Waterfowl Park, Sackville NB, there is potential for both bacterial and fungal exposure. 

For ampicillin in particular, there are a lot of commensal bacteria that have built up resistance to the antibiotic due to its widespread use in medicine and agriculture (Gjonbalaj et. al., 2020). These bacteria have even been found to degrade ampicillin (Gjonbalaj et. al., 2020), and therefore theoretically this should lead to less fungal growth because there would be less antibiotic present and more commensal bacteria competing for the resources available in the plates. 

##Taking a closer look at In3:

```{r Calling up Image for In3, October 28, 2024}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_28/IMG_2381.jpeg")
```

As can be seen in this image, all of the ampicillin plates exhibit more bacterial growth than the other antibiotic plates.There are also no fungi visible in the ampicillin plates, and there are fungi present in the kanamycin and streptomycin plates. 

##Taking a closer look at Out3:

```{r Calling up Image for Out3, October 28, 2024}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_28/IMG_2394.jpeg")
```

A similar trend is observed in this image, all of the ampicillin plates contain lawns of bacterial growth, and no fungi observed. In the kanamycin and streptomycin plates where less bacterial growth is observed, there is fungal growth in every plate. 

These results align with observations made by Jiang et al. (2017), showing that with increased bacterial growth there is less fungal growth. And, with antibiotics preventing bacterial growth there is more likelihood of fungal growth because fungi have natural antibiotic resistance and there is less competition for resources with bacteria if bacterial growth is lower. 

##Fungi-Fungi Inhibition:

In our plates, there are some instances of fungi inhibiting other fungal growth, creating zones of inhibition.

For example, lets take a look at In2:

```{r Calling up Image for In2, October 28, 2024}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_28/IMG_2375.jpeg")
```

In this image, you can see in the third streptomycin replicate (bottom right) that there is inibition of one fungi on the growth of another. The fluffy white fungus has grown around the circular, more beige fungus, leaving what can be described as a zone of inhibition between the two where there is no growth (edges of the two fungi do not extend and meet). 

```{r Calling up Image for Out1, October 29, 2024}}
knitr::include_graphics("~/Documents/github/antibiotic_resistance/Data/Images/2024_10_29/IMG_2400.jpeg")
```

In this image, the second and third streptomycin replicates (bottom row, middle and far right) also show fungi-fungi inhibition. There are similar zones of inhibition forming between different fungi growing on these plates. In the second streptomycin replicate, you can see the beige and white fungi will not extend and grow near each other (this image was from the last day of data collection so any extension that could have happened would have at this point), and in the third replicate a similar event can be seen with the beige fungus and the white fungi with green centres. 

Why does fungi-fungi inhibition occur?

##Fungal Growth and location

# Bibliography

Bondarczuk, K., Markowicz, A., Piotrowska-Seget, Z., 2016. The urgent need for risk assessment on the antibiotic resistance spread via sewage sludge land application. Environment International 87, 49–55. https://doi.org/10.1016/j.envint.2015.11.011

Gjonbalaj, M., Keith, J.W., Do, M.H., Hohl, T.M., Pamer, E.G., Becattini, S., 2020. Antibiotic Degradation by Commensal Microbes Shields Pathogens. Infect Immun 88, e00012-20. https://doi.org/10.1128/IAI.00012-20

Jiang, T.T., Shao, T.-Y., Ang, W.X.G., Kinder, J/M., Turner, L.H., Pham, G., Whitt, J., Alenghat, T., Way, S.S., 2017. Commensal Fungi Recapitulate the Protective Benefits of Intestinal Bacteria. Cell Host & Microbe 22, 809-816.e4. https://doi.org/10.1016/j.chom.2017.10.013

Khan, S., Hong, H., Bass, S., Wang, Y., Wang, X.-F., Sims, O.T., Koval, C.E., Kapoor, A., Lindenmeyer, C.C., 2024. Comparison of fungal vs bacterial infections in the medical intensive liver unit: Cause or corollary for high mortality? World J Hepatol 16, 379–392. https://doi.org/10.4254/wjh.v16.i3.379

Liu, Y., Li, J., Du, J., Hu, M., Bai, H., Qi, J., Gao, C., Wei, T., Su, H., Jin, J., Gao, P., 2011. Accurate assessment of antibiotic susceptibility and screening resistant strains of a bacterial population by linear gradient plate. Sci. China Life Sci. 54, 953–960. https://doi.org/10.1007/s11427-011-4230-6

Weinberg, E.D., 1959. Gradient Agar Plates.

